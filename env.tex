\usepackage{lastpage}

\newcommand{\BibTeX}{${\mathrm{B{\scriptstyle{IB}} \! T\!_{\displaystyle E} \! X}}$}

\newcommand{\pglabel}[1]{\phantomsection\label{#1}}


\newcommand\fillpic[1]{%
  \setbox0\hbox{\includegraphics*[keepaspectratio=true,]{#1}}%
  % ^ this measures the dimensions of the graphics
  \begin{tikzpicture}[overlay,%<-allow the picture to go over the page borders
   remember picture%<-access to page anchors like page.center
   ]
  \pgfmathsetmacro{\myscale}{min(\the\paperwidth/\the\wd0,\the\paperheight/\the\ht0)}%   
  % ^ compute the scale factor as the minimum of ... to make sure the graphics does not overshoot
   \node at (current page.center){\includegraphics*[keepaspectratio=true,%
    scale=\myscale]{#1}};% <- add the graphics with the appropriate scale
    % at the center of the page.
  \end{tikzpicture}}

\newcommand{\checkresult}[1]{\thispagestyle{empty}\clearpage%
\if\relax\detokenize{#1}\relax
  \textcolor{red}{\Large 在此插入審定書}\pglabel{pg:certificate}\clearpage%
\else
    {\pglabel{pg:certificate}
    \fillpic{#1}%
    }
\clearpage%
\fi}

\newcommand{\zhen}{en}
\newcommand{\isen}{en}

\newcommand{\linkurl}[2]{\href{#1}{\textcolor{blue}{#2}}}
\newcommand{\linkpg}[2]{\hyperref[#1]{\textcolor{blue}{#2}}}

\newcommand*{\minwidthbox}[2]{%
  \makebox[{\ifdim#1<\width\width\else#1\fi}]{#2}%
}
\newcommand{\centerbox}[2]{\minwidthbox{#1}{\hfill #2\hfill}}
 
\newcommand{\acktitle}{誌\hspace{1em}謝}

\newcommand{\setlang}[1]{%
\def\setlangen{en}
\def\setlangarg{#1}
\ifx \setlangen\setlangarg %
    \renewcommand{\tablename}{Table}
    \renewcommand{\figurename}{Figure}
    \renewcommand{\contentsname}{Table of Contents}
    \renewcommand{\listtablename}{List of Tables}
    \renewcommand{\listfigurename}{List of Figures}
    \renewcommand{\acktitle}{Acknowledgements}
    \renewcommand{\bibname}{Reference}
    \titleformat{\chapter}[hang]{\centering\fontsize{20}{30}\bfseries}{Chapter\hspace{1ex}\thechapter}{0.5em}{}
    \titlecontents{chapter}[0em]{}{Chapter\hspace{1ex}\thecontentslabel\hspace{0.5em}}{}{\titlerule*{.}\contentspage}
\else
    \renewcommand{\tablename}{表}
    \renewcommand{\figurename}{圖}
    \renewcommand{\contentsname}{目\hspace{1em}錄}
    \renewcommand{\listtablename}{表目錄}
    \renewcommand{\listfigurename}{圖目錄}
    \renewcommand{\acktitle}{誌\hspace{1em}謝}
    \renewcommand{\bibname}{參考文獻}
    \titleformat{\chapter}[hang]{\centering\fontsize{20}{30}\bfseries}{第\CJKnumber{\thechapter}章}{1em}{}
    \titlecontents{chapter}[0em]{}{第\CJKnumber{\thecontentslabel}章\hspace{1em}}{}{\titlerule*{.}\contentspage}
\fi\let\setlangen\relax\let\setlangarg\relax}

\newcommand{\titlezh}{}
\newcommand{\titleen}{}
\newcommand{\ptitlezh}{}
\newcommand{\ptitleen}{}
\newcommand{\authorzh}{}
\newcommand{\authoren}{}
\newcommand{\advisorzh}{}
\newcommand{\advisoren}{}
\newcommand{\degreezh}{}
\newcommand{\degreeen}{}
\newcommand{\depzh}{}
\newcommand{\depen}{}
\newcommand{\schoolzh}{}
\newcommand{\schoolen}{}
\newcommand{\yearzh}{}
\newcommand{\yearen}{}
\newcommand{\monzh}{}
\newcommand{\monen}{}
\newcommand{\semesterzh}{}
\newcommand{\semesteren}{}

\newcommand{\settitles}[2]{%
\renewcommand{\titlezh}{#1}
\renewcommand{\titleen}{#2}
\renewcommand{\ptitlezh}{\titlezh}
\renewcommand{\ptitleen}{\titleen}
}

\newcommand{\setbigtitleszh}[1]{%
\renewcommand{\ptitlezh}{#1}
}
\newcommand{\setbigtitlesen}[1]{%
\renewcommand{\ptitleen}{#1}
}
\newcommand{\setbigtitles}[2]{%
\renewcommand{\ptitlezh}{#1}
\renewcommand{\ptitleen}{#2}
}

\newcommand{\makeTOC}{\tableofcontents
\addcontentsline{toc}{chapter}{{\contentsname}}}


\newcommand{\maketitlepage}{%
\begin{titlepage}\pglabel{pg:titlepage}
\linespread{1.5}
    \begin{center}
    {
    {\fontsize{24}{30}\selectfont
    \includegraphics[width=0.75\textwidth]{fig/Logo1.png}\\
        {
            {\textbf{\depzh\degreezh{}班}}\\
            {\textbf{\degreezh{}學位論文}}\\
        }
    }
    {%
    \linespread{1}
    \fontsize{18}{18}\selectfont\vspace{5em}
    }
    {\fontsize{24}{28}\selectfont
        {\setlength\baselineskip{32pt}\linespread{1}
            {\textbf{\ptitlezh}}\\
        }
    }
    {\fontsize{20}{28}\selectfont
        {\setlength\baselineskip{32pt}\linespread{1}
            {
            \textbf{\ptitleen}
            }\\
            \vfil
        }
    } 
    {\fontsize{18}{18}\selectfont\linespread{1}
            {\textbf{研究生：\authorzh}}\\[4em]
            {\textbf{指導教授：\advisorzh\hspace{1em}博士}}\\[3em]
            {\textbf{中華民國\yearzh{}年\monzh}}
    }
    }
    \end{center}
\end{titlepage}%
}

\newcommand{\makecoverpage}{\DraftwatermarkOptions{stamp=false}%
\begin{titlepage}\pglabel{pg:coverpage}
\linespread{1.5}
    % \renewcommand{\baselinestretch}{1.5}
    \begin{center}
    {
    {\fontsize{24}{30}\selectfont
        {
            {\textbf{\schoolzh}}\\
            {\textbf{\depzh\degreezh{}班}}\\
            {\textbf{\degreezh{}學位論文}}\\
        }
    }
    {%
    \linespread{1}
    \fontsize{18}{18}\selectfont\vspace{5em}
    }
    {\fontsize{24}{28}\selectfont
        {\setlength\baselineskip{32pt}\linespread{1}
            {\textbf{\ptitlezh}}\\
        }
    }
    {\fontsize{20}{28}\selectfont
        {\setlength\baselineskip{32pt}\linespread{1}
            {
            \textbf{\ptitleen}
            }\\
            \vfil
        }
    } 
    {\fontsize{18}{18}\selectfont\linespread{1}
            {\textbf{研究生：\authorzh}}\\[4em]
            {\textbf{指導教授：\advisorzh\hspace{1em}博士}}\\[3em]
            {\textbf{中華民國\yearzh{}年\monzh}}
    }
    }
    \end{center}
\end{titlepage}%
\clearpage\thispagestyle{empty}\mbox{}\clearpage
\DraftwatermarkOptions{stamp=true}}

\newcommand{\makeverifmaster}[2]{\begin{titlepage}
\begin{center}
\linespread{1.2}
\fontsize{20}{22}\selectfont\bfseries
\mbox{}\\
    國立臺北科技大學\\
    研究所碩士學位論文口試委員會審定書
\end{center}

\linespread{1.8}
\fontsize{14}{14}\selectfont
\hspace{2em}本校\underline{\centerbox{6em}{\enspace#1\enspace}}研究所\underline{\centerbox{8em}{\enspace#2\enspace}}君\\[1em]
所提論文，經本委員會審定通過，合於碩士資格，特此證明。

\noindent 學位考試委員會\\
\begin{tabular}{p{5.5em}rp{10em}}
     &委\hspace{2em}員：&  \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & 指導教授：\\ \cline{3-3}
     & & \\
     & 所\hspace{2em}長：\\ \cline{3-3}
\end{tabular}
\vfill
\begin{center}
\fontsize{16}{16}\selectfont
中\,華\,民\,國\hspace{1em}\yearzh\hspace{1em}年\hspace{3em}月\hspace{3em}日
\end{center}
\vspace{3em}
\end{titlepage}}

\newcommand{\makeverifphd}[2]{\begin{titlepage}
\begin{center}
\linespread{1.2}
\fontsize{20}{22}\selectfont\bfseries
\mbox{}\\
    國立臺北科技大學\\
    研究所博士學位論文口試委員會審定書
\end{center}

\linespread{1.8}
\fontsize{14}{14}\selectfont
\hspace{2em}本校\underline{\centerbox{6em}{\enspace#1\enspace}}研究所\underline{\centerbox{8em}{\enspace#2\enspace}}君\\[1em]
所提論文，經本委員會審定通過，合於碩士資格，特此證明。

\noindent 學位考試委員會\\
\begin{tabular}{p{5.5em}rp{10em}}
     &委員兼召集人：& \\ \cline{3-3}
     & & \\
     &委\hspace{2em}員：&  \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & & \\ \cline{3-3}
     & & \\
     & 指導教授：\\ \cline{3-3}
     & & \\
     & 所\hspace{2em}長：\\ \cline{3-3}
\end{tabular}
\vfill
\begin{center}
\fontsize{16}{16}\selectfont
中\,華\,民\,國\hspace{1em}\yearzh\hspace{1em}年\hspace{3em}月\hspace{3em}日
\end{center}
\vspace{0em}
\end{titlepage}}

\newcommand{\makecontentlists}{\input{makelists}}

\newcommand{\starttext}{\pagenumbering{arabic}\setcounter{page}{1}}

\newcommand{\showcmd}[1]{\textbackslash{}#1}

\newenvironment{init}
{%
\pagenumbering{roman}
\setcounter{page}{1}\par}
{\clearpage\pagenumbering{arabic}}

\newenvironment{abszh}[1]
{\pglabel{pg:abszh}
{\centering\fontsize{12}{12}\selectfont\linespread{1.5}\vspace{1em}
\chapter*{摘\hspace{1em}要}
\addcontentsline{toc}{chapter}{{摘\hspace{1em}要}}
\vspace{1ex}}
{\setlength\parindent{0em}
論文名稱：\titlezh\\
頁數：\pageref{LastPage}頁\\
校所別：\schoolzh\enspace \depzh\degreezh{}班\\
畢業時間：\yearzh{}學年度\enspace 第\semesterzh{}學期\\
學位：\degreezh\\
研究生：\authorzh\\
指導教授：\advisorzh\enspace 博士\\
關鍵詞：{#1} \par
}
\setlength\parindent{2em}
}
{\clearpage}

\newenvironment{absen}[1]
{
{\centering\fontsize{12}{12}\selectfont\linespread{1.5}\vspace{1em}
\chapter*{ABSTRACT}
\addcontentsline{toc}{chapter}{{ABSTRACT}}
\vspace{1ex}}
{\setlength\parindent{0em}
Title      : \titleen\\         
Pages      : \pageref{LastPage} pages\\
School     : \schoolen\\
Department : \depen\\
Time       : \monen, \yearen\\
Degree     : \degreeen\\
Researcher : \authoren\\
Advisor    : \advisoren, Ph.D.\\
%\hspace{-0.75cm}\\
Keyword    :{#1} \par
}
\setlength\parindent{2em}
}
{\clearpage}

\newenvironment{ack}
{
{\centering\fontsize{12}{12}\selectfont\linespread{1.5}\vspace{1em}
\chapter*{\acktitle}
\addcontentsline{toc}{chapter}{{\acktitle}}
\vspace{1ex}}
\setlength\parindent{2em}
}
{\clearpage}